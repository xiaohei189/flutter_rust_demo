# ğŸ“ é¡¹ç›®æ¶æ„è¯´æ˜

## æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Flutter èŠå¤©åº”ç”¨æ¶æ„               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Presentation Layer             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ èŠå¤©é¡µ â”‚  â”‚è”ç³»äººé¡µâ”‚  â”‚ä¸ªäººä¸­å¿ƒâ”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚         â†‘          â†‘          â†‘             â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                    â”‚                        â”‚
â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚            â”‚  MainScreen   â”‚                â”‚
â”‚            â”‚ (åº•éƒ¨å¯¼èˆªæ )   â”‚                â”‚
â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             Widget Layer                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ MessageBubbleâ”‚  â”‚  ChatInput  â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚  â”‚ChatListItem â”‚                            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Data Layer                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  User  â”‚  â”‚ Message â”‚  â”‚ Chat â”‚         â”‚
â”‚  â”‚ Model  â”‚  â”‚  Model  â”‚  â”‚Model â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Backend (Future)                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚      Rust Backend (å¯é€‰)       â”‚         â”‚
â”‚  â”‚  - WebSocket å®æ—¶æ¶ˆæ¯          â”‚         â”‚
â”‚  â”‚  - æ¶ˆæ¯åŠ å¯†                    â”‚         â”‚
â”‚  â”‚  - æ•°æ®åº“æ“ä½œ                  â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“‚ ç›®å½•ç»“æ„è¯¦è§£

```
lib/
â”‚
â”œâ”€â”€ main.dart                     # åº”ç”¨å…¥å£ï¼Œåˆå§‹åŒ–é…ç½®
â”‚   â”œâ”€â”€ main()                   # ä¸»å‡½æ•°ï¼Œåˆå§‹åŒ– RustLib
â”‚   â””â”€â”€ MyApp                    # æ ¹ç»„ä»¶ï¼Œé…ç½®ä¸»é¢˜å’Œè·¯ç”±
â”‚
â”œâ”€â”€ ğŸ“ models/                   # æ•°æ®æ¨¡å‹å±‚
â”‚   â”œâ”€â”€ user.dart                # ç”¨æˆ·æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ User                 # ç”¨æˆ·ç±»
â”‚   â”‚   â”œâ”€â”€ currentUser          # å½“å‰ç”¨æˆ·ï¼ˆæ¨¡æ‹Ÿï¼‰
â”‚   â”‚   â””â”€â”€ mockUsers            # æ¨¡æ‹Ÿç”¨æˆ·åˆ—è¡¨
â”‚   â”‚
â”‚   â”œâ”€â”€ message.dart             # æ¶ˆæ¯æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ MessageType          # æ¶ˆæ¯ç±»å‹æšä¸¾
â”‚   â”‚   â””â”€â”€ Message              # æ¶ˆæ¯ç±»
â”‚   â”‚
â”‚   â””â”€â”€ chat.dart                # èŠå¤©ä¼šè¯æ¨¡å‹
â”‚       â”œâ”€â”€ Chat                 # èŠå¤©ä¼šè¯ç±»
â”‚       â””â”€â”€ mockChats            # æ¨¡æ‹ŸèŠå¤©åˆ—è¡¨
â”‚
â”œâ”€â”€ ğŸ“ screens/                  # é¡µé¢å±‚ï¼ˆè§†å›¾ï¼‰
â”‚   â”œâ”€â”€ main_screen.dart         # ä¸»æ¡†æ¶é¡µé¢
â”‚   â”‚   â””â”€â”€ MainScreen           # åŒ…å«åº•éƒ¨å¯¼èˆªæ çš„ä¸»é¡µé¢
â”‚   â”‚       â”œâ”€â”€ ChatListScreen   
â”‚   â”‚       â”œâ”€â”€ ContactsScreen   
â”‚   â”‚       â””â”€â”€ ProfileScreen    
â”‚   â”‚
â”‚   â”œâ”€â”€ chat_list_screen.dart    # èŠå¤©åˆ—è¡¨é¡µ
â”‚   â”‚   â””â”€â”€ ChatListScreen       # æ˜¾ç¤ºæ‰€æœ‰èŠå¤©ä¼šè¯
â”‚   â”‚       â””â”€â”€ ChatListItem (widget)
â”‚   â”‚
â”‚   â”œâ”€â”€ chat_detail_screen.dart  # èŠå¤©è¯¦æƒ…é¡µ
â”‚   â”‚   â””â”€â”€ ChatDetailScreen     # å•ä¸ªèŠå¤©çš„è¯¦ç»†ç•Œé¢
â”‚   â”‚       â”œâ”€â”€ MessageBubble (widget)
â”‚   â”‚       â””â”€â”€ ChatInput (widget)
â”‚   â”‚
â”‚   â”œâ”€â”€ contacts_screen.dart     # è”ç³»äººé¡µ
â”‚   â”‚   â””â”€â”€ ContactsScreen       # æ˜¾ç¤ºå¥½å‹åˆ—è¡¨
â”‚   â”‚
â”‚   â””â”€â”€ profile_screen.dart      # ä¸ªäººä¸­å¿ƒé¡µ
â”‚       â””â”€â”€ ProfileScreen        # ç”¨æˆ·ä¿¡æ¯å’Œè®¾ç½®
â”‚
â”œâ”€â”€ ğŸ“ widgets/                  # é€šç”¨ç»„ä»¶å±‚
â”‚   â”œâ”€â”€ chat_list_item.dart      # èŠå¤©åˆ—è¡¨é¡¹ç»„ä»¶
â”‚   â”‚   â””â”€â”€ ChatListItem         # å•ä¸ªèŠå¤©ä¼šè¯çš„åˆ—è¡¨é¡¹
â”‚   â”‚       â”œâ”€â”€ å¤´åƒæ˜¾ç¤º
â”‚   â”‚       â”œâ”€â”€ åœ¨çº¿çŠ¶æ€
â”‚   â”‚       â”œâ”€â”€ æœ€åæ¶ˆæ¯
â”‚   â”‚       â””â”€â”€ æœªè¯»æ•°é‡
â”‚   â”‚
â”‚   â”œâ”€â”€ message_bubble.dart      # æ¶ˆæ¯æ°”æ³¡ç»„ä»¶
â”‚   â”‚   â””â”€â”€ MessageBubble        # å•æ¡æ¶ˆæ¯çš„æ°”æ³¡æ ·å¼
â”‚   â”‚       â”œâ”€â”€ å·¦å³å¯¹é½
â”‚   â”‚       â”œâ”€â”€ é¢œè‰²åŒºåˆ†
â”‚   â”‚       â””â”€â”€ æ—¶é—´æ˜¾ç¤º
â”‚   â”‚
â”‚   â””â”€â”€ chat_input.dart          # èŠå¤©è¾“å…¥æ¡†ç»„ä»¶
â”‚       â””â”€â”€ ChatInput            # å¤šåŠŸèƒ½è¾“å…¥æ¡†
â”‚           â”œâ”€â”€ æ–‡æœ¬è¾“å…¥
â”‚           â”œâ”€â”€ è¯­éŸ³æŒ‰é’®
â”‚           â”œâ”€â”€ æ›´å¤šåŠŸèƒ½
â”‚           â””â”€â”€ å‘é€æŒ‰é’®
â”‚
â”œâ”€â”€ ğŸ“ theme/                    # ä¸»é¢˜é…ç½®å±‚
â”‚   â””â”€â”€ app_theme.dart           # åº”ç”¨ä¸»é¢˜
â”‚       â””â”€â”€ AppTheme             # ä¸»é¢˜é…ç½®ç±»
â”‚           â”œâ”€â”€ é¢œè‰²å®šä¹‰
â”‚           â”œâ”€â”€ æ–‡å­—æ ·å¼
â”‚           â””â”€â”€ lightTheme
â”‚
â””â”€â”€ ğŸ“ src/rust/                 # Rust æ¡¥æ¥ï¼ˆå·²æœ‰ï¼‰
    â””â”€â”€ ...                      # flutter_rust_bridge ç”Ÿæˆçš„ä»£ç 
```

## ğŸ”„ æ•°æ®æµ

### 1. æ¶ˆæ¯å‘é€æµç¨‹

```
ç”¨æˆ·è¾“å…¥
   â†“
ChatInput ç»„ä»¶æ•è·
   â†“
ChatDetailScreen å¤„ç†
   â†“
åˆ›å»º Message å¯¹è±¡
   â†“
æ›´æ–° State (setState)
   â†“
ListView åˆ·æ–°æ˜¾ç¤º
   â†“
è‡ªåŠ¨æ»šåŠ¨åˆ°åº•éƒ¨
   â†“
(æœªæ¥) å‘é€åˆ° Rust åç«¯
   â†“
(æœªæ¥) WebSocket æ¨é€åˆ°æœåŠ¡å™¨
```

### 2. é¡µé¢å¯¼èˆªæµç¨‹

```
MainScreen (åº•éƒ¨å¯¼èˆª)
   â”œâ”€ ç‚¹å‡»èŠå¤© Tab â†’ ChatListScreen
   â”‚      â†“
   â”‚   ç‚¹å‡»èŠå¤©é¡¹
   â”‚      â†“
   â”‚   Navigator.push â†’ ChatDetailScreen
   â”‚
   â”œâ”€ ç‚¹å‡»è”ç³»äºº Tab â†’ ContactsScreen
   â”‚
   â””â”€ ç‚¹å‡»æˆ‘çš„ Tab â†’ ProfileScreen
```

### 3. çŠ¶æ€ç®¡ç†ï¼ˆå½“å‰ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  StatefulWidget     â”‚
â”‚  â”œâ”€ State          â”‚
â”‚  â””â”€ setState()     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
   å±€éƒ¨çŠ¶æ€æ›´æ–°
         â†“
    UI é‡æ–°æ¸²æŸ“
```

**æ³¨æ„**ï¼šå½“å‰ä½¿ç”¨åŸºç¡€çš„ `setState`ï¼Œå»ºè®®åç»­ä½¿ç”¨ Provider/Riverpod è¿›è¡Œå…¨å±€çŠ¶æ€ç®¡ç†ã€‚

## ğŸ¯ ç»„ä»¶èŒè´£

### Screensï¼ˆé¡µé¢ï¼‰
- è´Ÿè´£é¡µé¢çº§åˆ«çš„å¸ƒå±€
- å¤„ç†ç”¨æˆ·äº¤äº’é€»è¾‘
- ç®¡ç†é¡µé¢çŠ¶æ€
- åè°ƒå¤šä¸ª Widget

### Widgetsï¼ˆç»„ä»¶ï¼‰
- è´Ÿè´£å•ä¸€åŠŸèƒ½çš„ UI å±•ç¤º
- å¯å¤ç”¨çš„é€šç”¨ç»„ä»¶
- æ¥æ”¶å‚æ•°é…ç½®
- å‘é€äº‹ä»¶å›è°ƒ

### Modelsï¼ˆæ¨¡å‹ï¼‰
- å®šä¹‰æ•°æ®ç»“æ„
- æä¾›æ¨¡æ‹Ÿæ•°æ®
- æ•°æ®è½¬æ¢å’Œå¤„ç†
- ä¸šåŠ¡é€»è¾‘å°è£…

### Themeï¼ˆä¸»é¢˜ï¼‰
- ç»Ÿä¸€é¢œè‰²å®šä¹‰
- ç»Ÿä¸€æ ·å¼é…ç½®
- æ”¯æŒä¸»é¢˜åˆ‡æ¢
- Material Design 3 é…ç½®

## ğŸš€ æ‰©å±•å»ºè®®

### 1. çŠ¶æ€ç®¡ç†é›†æˆ

```dart
// æ¨èä½¿ç”¨ Riverpod
lib/
â”œâ”€â”€ providers/
â”‚   â”œâ”€â”€ chat_provider.dart
â”‚   â”œâ”€â”€ user_provider.dart
â”‚   â””â”€â”€ message_provider.dart
```

### 2. ç½‘ç»œå±‚

```dart
lib/
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ api_service.dart       // REST API
â”‚   â”œâ”€â”€ websocket_service.dart // WebSocket
â”‚   â””â”€â”€ auth_service.dart      // è®¤è¯
```

### 3. æ•°æ®æŒä¹…åŒ–

```dart
lib/
â”œâ”€â”€ repositories/
â”‚   â”œâ”€â”€ chat_repository.dart
â”‚   â”œâ”€â”€ user_repository.dart
â”‚   â””â”€â”€ message_repository.dart
```

### 4. è·¯ç”±ç®¡ç†

```dart
lib/
â”œâ”€â”€ routes/
â”‚   â”œâ”€â”€ app_router.dart        // è·¯ç”±é…ç½®
â”‚   â””â”€â”€ route_names.dart       // è·¯ç”±å¸¸é‡
```

### 5. å·¥å…·ç±»

```dart
lib/
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ date_formatter.dart
â”‚   â”œâ”€â”€ validators.dart
â”‚   â””â”€â”€ constants.dart
```

## ğŸ”Œ Rust é›†æˆæ¶æ„

```
Flutter (Dart)
      â†•
flutter_rust_bridge
      â†•
Rust (Native)
   â”œâ”€â”€ WebSocket å®¢æˆ·ç«¯
   â”œâ”€â”€ æ¶ˆæ¯åŠ å¯†/è§£å¯†
   â”œâ”€â”€ æœ¬åœ°æ•°æ®åº“ (SQLite)
   â””â”€â”€ é«˜æ€§èƒ½è®¡ç®—
```

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **ListView.builder**: å·²ä½¿ç”¨ï¼Œæ”¯æŒæ‡’åŠ è½½
2. **const æ„é€ å‡½æ•°**: å‡å°‘é‡å»º
3. **å›¾ç‰‡ç¼“å­˜**: ä½¿ç”¨ `cached_network_image`
4. **æ¶ˆæ¯åˆ†é¡µ**: å®ç°å†å²æ¶ˆæ¯åŠ è½½
5. **å†…å­˜ç®¡ç†**: åŠæ—¶ dispose æ§åˆ¶å™¨

## ğŸ§ª æµ‹è¯•ç­–ç•¥

```
tests/
â”œâ”€â”€ unit/                 # å•å…ƒæµ‹è¯•
â”‚   â”œâ”€â”€ models/
â”‚   â””â”€â”€ utils/
â”œâ”€â”€ widget/               # ç»„ä»¶æµ‹è¯•
â”‚   â”œâ”€â”€ widgets/
â”‚   â””â”€â”€ screens/
â””â”€â”€ integration/          # é›†æˆæµ‹è¯•
    â””â”€â”€ app_test.dart
```

## ğŸ“± å¤šå¹³å°æ”¯æŒ

å½“å‰æ¶æ„æ”¯æŒï¼š
- âœ… Android
- âœ… iOS
- âœ… Web
- âœ… Windows
- âœ… macOS
- âœ… Linux

## ğŸ¨ è®¾è®¡æ¨¡å¼

- **å•ä¸€èŒè´£åŸåˆ™**: æ¯ä¸ªç»„ä»¶è´Ÿè´£å•ä¸€åŠŸèƒ½
- **ç»„ä»¶åŒ–**: é€šç”¨ç»„ä»¶ç‹¬ç«‹å°è£…
- **æ•°æ®é©±åŠ¨**: UI ç”±æ•°æ®çŠ¶æ€å†³å®š
- **åˆ†å±‚æ¶æ„**: å±•ç¤ºå±‚ã€ä¸šåŠ¡å±‚ã€æ•°æ®å±‚åˆ†ç¦»

---

**è¯¥æ¶æ„ä¸ºåˆå§‹éª¨æ¶ï¼Œå¯æ ¹æ®å®é™…éœ€æ±‚æ‰©å±•å’Œä¼˜åŒ–ã€‚**



